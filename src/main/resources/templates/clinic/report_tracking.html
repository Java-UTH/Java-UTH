<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Báo cáo & Rủi ro Bệnh nhân | Hệ thống AI Võng mạc</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            padding: 20px;
        }
        .container-report {
            max-width: 1400px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .risk-high {
            background-color: #fceceb; 
            font-weight: 600;
        }
        .risk-moderate {
            background-color: #fff9e6; 
        }
        .risk-score-badge {
            font-weight: 700;
            padding: 5px 10px;
            border-radius: 5px;
            min-width: 65px;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="container container-report">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-danger"><i class="fas fa-file-medical-alt me-2"></i> Báo cáo & Rủi ro Bệnh nhân</h2>
        <a th:href="@{/clinic/home}" class="btn btn-outline-secondary"><i class="fas fa-arrow-left me-1"></i> Về Dashboard</a>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <div class="row g-3 align-items-end">
                <div class="col-md-3">
                    <label for="searchPatient" class="form-label fw-bold">Tìm kiếm Bệnh nhân</label>
                    <input type="text" class="form-control" id="searchPatient" placeholder="Mã BN, Tên BN...">
                </div>
                <div class="col-md-3">
                    <label for="filterRisk" class="form-label fw-bold">Lọc theo Mức độ Rủi ro</label>
                    <select id="filterRisk" class="form-select">
                        <option selected value="all">Tất cả (Total Reports)</option>
                        <option value="high">Nguy cơ CAO (> 80%)</option>
                        <option value="moderate">Nguy cơ Trung bình (50% - 80%)</option>
                        <option value="low">Nguy cơ Thấp (< 50%)</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="filterDoctor" class="form-label fw-bold">Lọc theo Bác sĩ</label>
                    <select id="filterDoctor" class="form-select">
                        <option selected value="all">Tất cả Bác sĩ</option>
                        <option value="dr_a">Bác sĩ A</option>
                        <option value="dr_b">Bác sĩ B</option>
                    </select>
                </div>
                <div class="col-md-3 d-flex justify-content-end">
                    <button class="btn btn-primary w-100 me-2"><i class="fas fa-filter me-1"></i> Lọc Dữ liệu</button>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-header bg-danger text-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><i class="fas fa-list-alt me-2"></i> Danh sách Báo cáo Phân tích (350 Kết quả)</h5>
            <a th:href="@{/reports/export/csv}" class="btn btn-light btn-sm fw-bold"><i class="fas fa-file-export me-1"></i> Xuất CSV (FR-30)</a>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Mã BN</th>
                            <th>Tên Bệnh nhân</th>
                            <th>Ngày Phân tích</th>
                            <th>Bác sĩ</th>
                            <th>Mã Chẩn đoán (AI)</th>
                            <th class="text-center">Điểm Rủi ro (FR-29)</th>
                            <th>Trạng thái Cảnh báo</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="risk-high">
                            <td>**BN-20250012**</td>
                            <td>**Trần Văn A**</td>
                            <td>14/12/2025 10:30</td>
                            <td>Bác sĩ A</td>
                            <td>DR Severe (R32.4)</td>
                            <td class="text-center">
                                <span class="risk-score-badge text-white bg-danger">92%</span>
                            </td>
                            <td><span class="badge bg-danger">Đã Cảnh báo</span></td>
                            <td><a th:href="@{/reports/view/1001}" class="btn btn-sm btn-danger"><i class="fas fa-eye"></i> Xem</a></td>
                        </tr>

                        <tr class="risk-moderate">
                            <td>BN-20250105</td>
                            <td>Nguyễn Thị D</td>
                            <td>13/12/2025 15:45</td>
                            <td>Bác sĩ B</td>
                            <td>Mild NPDR (R20.1)</td>
                            <td class="text-center">
                                <span class="risk-score-badge text-dark" style="background-color: #fcd53f;">65%</span>
                            </td>
                            <td><span class="badge bg-warning text-dark">Chưa Gửi</span></td>
                            <td><a th:href="@{/reports/view/1002}" class="btn btn-sm btn-warning"><i class="fas fa-eye"></i> Xem</a></td>
                        </tr>

                        <tr>
                            <td>BN-20250211</td>
                            <td>Phạm Văn E</td>
                            <td>12/12/2025 08:00</td>
                            <td>Bác sĩ C</td>
                            <td>Healthy</td>
                            <td class="text-center">
                                <span class="risk-score-badge text-white bg-success">15%</span>
                            </td>
                            <td><span class="badge bg-secondary">Không cần</span></td>
                            <td><a th:href="@{/reports/view/1003}" class="btn btn-sm btn-success"><i class="fas fa-eye"></i> Xem</a></td>
                        </tr>

                        </tbody>
                </table>
            </div>
        </div>
        <div class="card-footer d-flex justify-content-end">
            <nav aria-label="Page navigation">
                <ul class="pagination pagination-sm mb-0">
                    <li class="page-item disabled"><a class="page-link" href="#">Trước</a></li>
                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item"><a class="page-link" href="#">Sau</a></li>
                </ul>
            </nav>
        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>